{
  "target_keys": ["Subject", "From", "To", "Date", "Reply-To", "Return-Path"],

  "prepare": {
    "qp_soft_break": "=\\s*[\\r\\n]+",
    "multi_space": "\\s+",
    "base64_block": "(?:[A-Za-z0-9+/]{50,}(?:\\s+)?)+" 
  },

  "headers": {
    "main": "^{key}:\\s*([\\s\\S]*?)(?=\\n\\S|$)",
    "from_fallback": "From:.*?\\n\\s*<(.*?)>"
  },

  "urls": {
    "extract": "https?://(?:<script>.*?</script>|[^\\s\"'<>])+",
    "nested": "[?&=](https?://[^\\s\"'<>]+)"
  },

  "attachments": {
    "filename": "filename=\"?([^\"\\n]+)\"?",
    "content_b64": "filename=\"{filename}\"[\\s\\S]+?Content-Transfer-Encoding:\\s*base64\\s*\\n\\n([A-Za-z0-9+/=\\r\\n]+?)\\n------="
  },

  "domain": {
    "email": "@([\\w.-]+)"
  },

  "ip": {
    "base": "\\b(?:\\d{1,3}\\.){3}\\d{1,3}\\b",
    "client": "client-ip\\s*=\\s*({ip})",
    "spf": "spf=pass.*?({ip})"
  },

  "auth": {
    "SPF": "domain of\\s+([\\w\\.-]+@)?([\\w\\.-]+)",
    "DKIM": "dkim-signature:.*?d=([\\w\\.-]+)",
    "DMARC": "dmarc=pass.*?header\\.from=([\\w\\.-]+)"
  }
}
